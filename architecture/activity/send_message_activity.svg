<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="ACTIVITY" height="954px" preserveAspectRatio="none" style="width:400px;height:954px;background:#FFFFFF;" version="1.1" viewBox="0 0 400 954" width="400px" zoomAndPan="magnify"><defs/><g><ellipse cx="209.1902" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207.2832" x="105.5486" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187.2832" x="115.5486" y="71.1387">User types and sends message</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="119.9082" x="149.2361" y="152.3711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.9082" x="159.2361" y="173.5098">Throw exception</text><ellipse cx="209.1902" cy="225.8555" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="209.1902" cy="225.8555" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><polygon fill="#F1F1F1" points="149.4583,103.9688,268.9221,103.9688,280.9221,115.9688,268.9221,127.9688,149.4583,127.9688,137.4583,115.9688,149.4583,103.9688" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="213.1902" y="138.1792">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="119.4639" x="149.4583" y="119.7769">User is unauthorized?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="280.9221" y="113.3745">No</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="96.7461" x="160.8171" y="327.2578"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="76.7461" x="170.8171" y="348.3965">Skip sending</text><ellipse cx="209.1902" cy="400.7422" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="209.1902" cy="400.7422" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><polygon fill="#F1F1F1" points="156.6313,278.8555,261.749,278.8555,273.749,290.8555,261.749,302.8555,156.6313,302.8555,144.6313,290.8555,156.6313,278.8555" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="213.1902" y="313.0659">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="105.1177" x="156.6313" y="294.6636">Message is empty?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="273.749" y="288.2612">No</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="211.3672" x="103.5066" y="453.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="191.3672" x="113.5066" y="474.8809">Save message locally (pending)</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="236.7559" x="90.8123" y="507.7109"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="216.7559" x="100.8123" y="528.8496">Show message offline saved to user</text><polygon fill="#F1F1F1" points="175.21,561.6797,243.1704,561.6797,255.1704,573.6797,243.1704,585.6797,175.21,585.6797,163.21,573.6797,175.21,561.6797" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67.9604" x="175.21" y="577.4878">User online?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="143.9922" y="571.0854">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="255.1704" y="571.0854">No</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="166.8711" x="19.8916" y="595.6797"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="146.8711" x="29.8916" y="616.8184">Send message to socket</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="117.8398" x="44.4072" y="649.6484"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="97.8398" x="54.4072" y="670.7871">Persist message</text><polygon fill="#F1F1F1" points="58.1885,703.6172,148.4658,703.6172,160.4658,715.6172,148.4658,727.6172,58.1885,727.6172,46.1885,715.6172,58.1885,703.6172" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="107.3271" y="737.8276">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="90.2773" x="58.1885" y="719.4253">Message saved?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="160.4658" y="713.0229">No</text><ellipse cx="197.4243" cy="715.6172" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="197.4243" cy="715.6172" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="146.5215" x="30.0664" y="759.3276"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="126.5215" x="40.0664" y="780.4663">Notify chat members</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="184.6543" x="11" y="813.2964"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="164.6543" x="21" y="834.4351">Mark message as delivered</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="149.2578" x="240.4243" y="595.6797"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="129.2578" x="250.4243" y="616.8184">Keep message offline</text><ellipse cx="315.0532" cy="660.6484" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="315.0532" cy="660.6484" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="196.6602" x="110.8601" y="867.2651"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="176.6602" x="120.8601" y="888.4038">Show message status to user</text><ellipse cx="209.1902" cy="932.2339" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="209.1902" cy="932.2339" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="30" y2="50"/><polygon fill="#181818" points="205.1902,40,209.1902,50,213.1902,40,209.1902,44" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="186.3398" y2="214.8555"/><polygon fill="#181818" points="205.1902,204.8555,209.1902,214.8555,213.1902,204.8555,209.1902,208.8555" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="127.9688" y2="152.3711"/><polygon fill="#181818" points="205.1902,142.3711,209.1902,152.3711,213.1902,142.3711,209.1902,146.3711" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="280.9221" x2="292.9221" y1="115.9688" y2="115.9688"/><polygon fill="#181818" points="288.9221,184.8555,292.9221,194.8555,296.9221,184.8555,292.9221,188.8555" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.9221" x2="292.9221" y1="115.9688" y2="258.8555"/><line style="stroke:#181818;stroke-width:1;" x1="292.9221" x2="209.1902" y1="258.8555" y2="258.8555"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="258.8555" y2="278.8555"/><polygon fill="#181818" points="205.1902,268.8555,209.1902,278.8555,213.1902,268.8555,209.1902,272.8555" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="83.9688" y2="103.9688"/><polygon fill="#181818" points="205.1902,93.9688,209.1902,103.9688,213.1902,93.9688,209.1902,97.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="361.2266" y2="389.7422"/><polygon fill="#181818" points="205.1902,379.7422,209.1902,389.7422,213.1902,379.7422,209.1902,383.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="302.8555" y2="327.2578"/><polygon fill="#181818" points="205.1902,317.2578,209.1902,327.2578,213.1902,317.2578,209.1902,321.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="273.749" x2="285.749" y1="290.8555" y2="290.8555"/><polygon fill="#181818" points="281.749,359.7422,285.749,369.7422,289.749,359.7422,285.749,363.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="285.749" x2="285.749" y1="290.8555" y2="433.7422"/><line style="stroke:#181818;stroke-width:1;" x1="285.749" x2="209.1902" y1="433.7422" y2="433.7422"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="433.7422" y2="453.7422"/><polygon fill="#181818" points="205.1902,443.7422,209.1902,453.7422,213.1902,443.7422,209.1902,447.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="487.7109" y2="507.7109"/><polygon fill="#181818" points="205.1902,497.7109,209.1902,507.7109,213.1902,497.7109,209.1902,501.7109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="103.3271" y1="629.6484" y2="649.6484"/><polygon fill="#181818" points="99.3271,639.6484,103.3271,649.6484,107.3271,639.6484,103.3271,643.6484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="103.3271" y1="727.6172" y2="759.3276"/><polygon fill="#181818" points="99.3271,749.3276,103.3271,759.3276,107.3271,749.3276,103.3271,753.3276" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="160.4658" x2="186.4243" y1="715.6172" y2="715.6172"/><polygon fill="#181818" points="176.4243,711.6172,186.4243,715.6172,176.4243,719.6172,180.4243,715.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="103.3271" y1="683.6172" y2="703.6172"/><polygon fill="#181818" points="99.3271,693.6172,103.3271,703.6172,107.3271,693.6172,103.3271,697.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="103.3271" y1="793.2964" y2="813.2964"/><polygon fill="#181818" points="99.3271,803.2964,103.3271,813.2964,107.3271,803.2964,103.3271,807.2964" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="315.0532" x2="315.0532" y1="629.6484" y2="649.6484"/><polygon fill="#181818" points="311.0532,639.6484,315.0532,649.6484,319.0532,639.6484,315.0532,643.6484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="163.21" x2="103.3271" y1="573.6797" y2="573.6797"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="103.3271" y1="573.6797" y2="595.6797"/><polygon fill="#181818" points="99.3271,585.6797,103.3271,595.6797,107.3271,585.6797,103.3271,589.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="255.1704" x2="315.0532" y1="573.6797" y2="573.6797"/><line style="stroke:#181818;stroke-width:1;" x1="315.0532" x2="315.0532" y1="573.6797" y2="595.6797"/><polygon fill="#181818" points="311.0532,585.6797,315.0532,595.6797,319.0532,585.6797,315.0532,589.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="103.3271" y1="847.2651" y2="852.2651"/><line style="stroke:#181818;stroke-width:1;" x1="103.3271" x2="209.1902" y1="852.2651" y2="852.2651"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="852.2651" y2="867.2651"/><polygon fill="#181818" points="205.1902,857.2651,209.1902,867.2651,213.1902,857.2651,209.1902,861.2651" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="541.6797" y2="561.6797"/><polygon fill="#181818" points="205.1902,551.6797,209.1902,561.6797,213.1902,551.6797,209.1902,555.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="209.1902" x2="209.1902" y1="901.2339" y2="921.2339"/><polygon fill="#181818" points="205.1902,911.2339,209.1902,921.2339,213.1902,911.2339,209.1902,915.2339" style="stroke:#181818;stroke-width:1;"/><!--SRC=[TP3DReCm48JlVeezmYl0eGzG9QgKzj2ZWvTWORoMTqbBdxusX1yrwjMU-NPcM7GKfQeFnWWo1MJGtW2ZDmm3CkiRrahP5efPOXb6hqVfADeVD2ybI8SUYa_aKW5KxrsaBy3l1eDOydLwOw6Wq352SQPI9R9j5-9fuMSe3a6c9zgbjs7EOltjVrHrqNTSmuAZHZitGH4MNradGPT2hG9gMsSz0YUN0I4OKx5ZH_Bv_pbCucsGP6DgUfGSgth3o9Pb7mpWs6- -jF5oyaSLW5nclV2eatXd4jjEq7GwCuThmiztJZhsMmJDOD3PEqOqzM6Lf7j537_xxlkjgnr7OT4oyhv6Llu2]--></g></svg>